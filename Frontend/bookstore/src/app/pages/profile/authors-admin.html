<section class="admin-page">
  <header class="admin-header">
    <h2>Gestión de Autores</h2>
    <div class="admin-actions">
      <button class="btn-primary" (click)="openCreateModal()">Crear</button>
    </div>
  </header>

  <div class="admin-container">
    <div class="author-table">
      <table>
        <colgroup>
          <col />
          <col />
          <col class="col-actions" />
        </colgroup>
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Fecha de nacimiento</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let g of authors">
            <td>{{ g.name }}</td>
            <td>{{ g.birthDate }}</td>
            <td class="actions">
              <button class="btn-small" title="Editar" (click)="openEditModal(g)">
                <i class="ri-edit-line"></i>
              </button>
              <button class="btn-small danger" title="Eliminar" (click)="deleteGenre(g)">
                <i class="ri-delete-bin-5-line"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
      <div *ngIf="!loading && genres.length === 0" class="empty">No hay autores.</div>
      <div *ngIf="loading" class="empty">Cargando...</div>
    </div>
  </div>
</section>

@if (showCreateModal) {
<div class="modal" (click)="closeCreateModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="modal-close" aria-label="Cerrar" (click)="closeCreateModal()">×</button>
    @if (isEditMode) {
    <h3>Editar Autor</h3>
    } @else {
    <h3>Crear Autor</h3>
    }
    <div class="modal-field">
      <label for="genreName">Nombre</label>
      <input id="genreName" name="genreName" [(ngModel)]="newGenreName" />
    </div>
    <div class="modal-field">
      <label for="genreDescription">Fecha de nacimiento (opcional)</label>
      <input id="genreDescription" name="genreDescription" [(ngModel)]="newGenreDescription" />
    </div>
    @if (createError) {
    <div class="error">{{ createError }}</div>
    }
    <div class="modal-actions">
      <button class="btn-primary" (click)="submitCreateOrEdit()" [disabled]="creating">
        @if (creating) {<span class="spinner" aria-hidden="true"></span>} @if (isEditMode) {Guardar}
        @else {Crear}
      </button>
      <button class="btn-secondary" (click)="closeCreateModal()" [disabled]="creating">
        Cancelar
      </button>
    </div>
  </div>
</div>
} @if (showDeleteModal) {
<div class="modal" (click)="cancelDelete()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="modal-close" aria-label="Cerrar" (click)="cancelDelete()">×</button>
    <h3>Confirmar eliminación</h3>
    <p>¿Estás seguro que deseas eliminar el autor| "{{ deleteTarget?.name }}"?</p>
    <div class="modal-actions">
      <button class="btn-primary" (click)="confirmDelete()" [disabled]="deleting">
        @if (deleting) {<span class="spinner" aria-hidden="true"></span>} Eliminar
      </button>
      <button class="btn-secondary" (click)="cancelDelete()" [disabled]="deleting">Cancelar</button>
    </div>
  </div>
</div>
}
